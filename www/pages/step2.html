<div class="container">
  <div class="description">
    <strong>Step2: Get your location</strong>
    <p>PhoneGap-GoogleMaps-Plugin allows you to get the device location easily.<br>
      Please enable location feature before execute this.</p>
    
    <pre class="prettyprint lang-js">
map.getMyLocation(onLocationSuccess, onLocationError);

function onLocationSuccess( result ) {
    alert(JSON.stringify( result, null, 4 ));
}
function onLocationError( error_obj ) {
    alert("Because of the plugin could not get your location, set California as your location");
}
</pre>
  </div>
</div>
<button id="execBtn">Execute</button>
<button id="nextBtn">Next</button>

<script type="text/javascript">
$(document).one("pageLoad", function() {
  
  $("#execBtn").one("touchStart click", function() {
    map.setDiv($("#map_canvas")[0]);
    $(this).remove();
  
    $(".container").fadeOut(function() {
      $(".container").remove();
      $("#execBtn").remove();
      
      setTimeout(function() {
        $("#nextBtn").show();
        
        // Because of the nextBtn is `display:none`,
        // the map plugin can not get the rectangle of it, at the first time.
        // 
        // Then the next button comes up.
        // 
        // In this case, you need to call `map.refreshLayout()`
        map.refreshLayout();
      }, 3000);
    });
  });
  
  $("#execBtn").one("touchStart click", function() {
    var option = {
      enableHighAccuracy: true  // force GPS
    };
    map.getMyLocation(option, function(result) {
      alert(JSON.stringify( result, null, 4 ));
      next(result);
    }, function(error_obj) {
      alert("Because of the plugin could not get your location, set California as your location");
      next({
        latLng: {
          lat: 37.422488,
          lng: -122.08422
        }
      });
    });
  });
  
  $("#nextBtn").one("touchStart click", function() {
    $(this).remove();
    loadPage("step3");
  });
});
</script>