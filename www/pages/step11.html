<div class="container">
  <div class="description">
    <strong>Step11: Reverse geocoding</strong>
    <p>You can get human readable address from latitude amp; longitude.</p>
    
    <pre class="prettyprint lang-js">
marker.setTitle("Please drag this marker");
marker.setDraggable(true);
marker.on(plugin.google.maps.event.MARKER_DRAG_END, onMarkerDragged);

function onMarkerDragged(marker) {
  marker.getPosition(function(latLng) {
    var request = {
      'position': latLng
    };
    plugin.google.maps.Geocoder.geocode(request, geocoderCallback);
  });
}

function geocoderCallback(results) {
  if (results.length) {
    var result = results[0];
    var position = result.position; 
    var address = [
      result.subThoroughfare || "",
      result.thoroughfare || "",
      result.locality || "",
      result.adminArea || "",
      result.postalCode || "",
      result.country || ""].join(", ");

    marker.setTitle(address);
    marker.showInfoWindow();
  } else {
    alert("Not found");
  }
}
</pre>
<button id="nextBtn">Execute &amp; next</button>
  </div>
  
</div>
<script type="text/javascript">
$(document).one("pageLoad", function(evt, marker) {
  map.setDiv($("#map_canvas")[0]);
  
  marker.hideInfoWindow();
  marker.setTitle("Please drag this marker");
  marker.setDraggable(true);
  marker.on(plugin.google.maps.event.MARKER_DRAG_END, onMarkerDragged);
    
  $("#nextBtn").one("touchStart click", function() {
    $(".container").addClass("animated rollOut");
    $(".container").one('webkitAnimationEnd animationend', function() {
      $(".container").remove();
      marker.showInfoWindow();
    });
  });
  
  function onMarkerDragged(marker) {
    marker.getPosition(function(latLng) {
      var request = {
        'position': latLng
      };
      plugin.google.maps.Geocoder.geocode(request, geocoderCallback);
    });
  }
  
  function geocoderCallback(results) {
    if (results.length) {
      var result = results[0];
      var position = result.position; 
      var address = [
        result.subThoroughfare || "",
        result.thoroughfare || "",
        result.locality || "",
        result.adminArea || "",
        result.postalCode || "",
        result.country || ""].join(", ");
  
      marker.setTitle(address);
      marker.showInfoWindow();
    } else {
      alert("Not found");
    }
    setTimeout(function() {
      loadPage("step12");
    }, 7000);
  }
});
</script>